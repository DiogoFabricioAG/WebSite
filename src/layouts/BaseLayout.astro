---
import "../styles/global.css";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="/iconopq.png" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Diogo Abregu</title>
	</head>
	<body class="bg-gray-900 text-white">
		<!-- Custom Cursor Elements -->
		<div id="cursor-dot" class="cursor-dot"></div>
		<div id="cursor-outline" class="cursor-outline"></div>
		
		<slot class="relative"/>
		
		<!-- Music Player Floating Widget -->
		<div id="music-player" class="fixed bottom-4 right-4 bg-black/90 backdrop-blur-md border border-white/80 p-3 shadow-2xl z-50 max-w-xs transition-all duration-500">
			<div class="space-y-2">

<style>
	/* Cursor Styles */
	body {
		cursor: none;
	}

	.cursor-dot {
		width: 8px;
		height: 8px;
		background: linear-gradient(135deg, #d5d8e7 0%, #cbc3d4 100%);
		border-radius: 50%;
		position: fixed;
		transform: translate(-50%, -50%);
		pointer-events: none;
		z-index: 9999;
		transition: transform 0.15s ease, opacity 0.15s ease;
		box-shadow: 0 0 20px rgba(242, 243, 245, 0.6);
	}

	.cursor-outline {
		width: 40px;
		height: 40px;
		border: 2px solid rgba(241, 241, 243, 0.5);
		border-radius: 50%;
		position: fixed;
		transform: translate(-50%, -50%);
		pointer-events: none;
		z-index: 9998;
		transition: width 0.2s ease, height 0.2s ease, opacity 0.2s ease, border-color 0.2s ease;
		box-shadow: 0 0 30px rgba(223, 224, 228, 0.3);
	}

	@keyframes pulse {
		0%, 100% {
			box-shadow: 0 0 30px rgba(251, 146, 60, 0.3);
		}
		50% {
			box-shadow: 0 0 50px rgba(251, 146, 60, 0.6);
		}
	}
</style>
				<!-- Song Info -->
				<div class="text-xs">
					<p class="text-white/60 text-[10px] mb-0.5">Estás escuchando</p>
					<p id="song-title" class="font-semibold text-white truncate"></p>
					<p class="text-white/60 text-[9px] mt-0.5">Powered by <strong>Suno AI</strong></p>
				</div>
				
				<!-- Controls -->
				<div class="flex items-center justify-between gap-2">
					<button id="prev-btn" class="p-1.5 hover:bg-white/10  transition" title="Anterior">
						<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
							<path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
						</svg>
					</button>
					
					<button id="play-pause-btn" class="p-2 bg-white/20 hover:bg-white/30 -full transition" title="Play/Pause">
						<svg id="play-icon" class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
							<path d="M8 5v14l11-7z"/>
						</svg>
						<svg id="pause-icon" class="w-5 h-5 hidden" fill="currentColor" viewBox="0 0 24 24">
							<path d="M6 4h4v16H6V4zm8 0h4v16h-4V4z"/>
						</svg>
					</button>
					
					<button id="next-btn" class="p-1.5 hover:bg-white/10  transition" title="Siguiente">
						<svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
							<path d="M16 18h2V6h-2zm-11-7l8.5-6v12z"/>
						</svg>
					</button>
					
					<button id="mute-btn" class="p-1.5 hover:bg-white/10  transition" title="Silenciar">
						<svg id="volume-icon" class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
							<path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z"/>
						</svg>
						<svg id="mute-icon" class="w-4 h-4 hidden" fill="currentColor" viewBox="0 0 24 24">
							<path d="M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z"/>
						</svg>
					</button>
				</div>
				
				<!-- Progress Bar -->
				<div class="w-full bg-white/10 h-1  overflow-hidden">
					<div id="progress-bar" class="bg-white/60 h-full w-0 transition-all"></div>
				</div>
			</div>
		</div>

		<audio id="audio-player" preload="metadata"></audio>

		<script is:inline>
			const playlist = [
				{ title: "Digital Daydreams", src: "/music/Digital Daydreams.mp3", instrumental: true },
				{ title: "Drifting Pixels", src: "/music/Drifting Pixels.mp3", instrumental: true },
				{ title: "Rise and Shine", src: "/music/Rise and Shine.mp3", instrumental: false },
				{ title: "Low Battery Love", src: "/music/Low Battery Love.mp3", instrumental: true },
				{ title: "El Corazón Canta", src: "/music/El Corazón Canta.mp3", instrumental: true },
				{ title: "Shadows in the Smoke", src: "/music/Shadows in the Smoke.mp3", instrumental: true },
				{ title: "Funky Collab Jam", src: "/music/Funky Collab Jam.mp3", instrumental: false },
				{ title: "Orchestral Ray", src: "/music/Orchestral Ray.mp3", instrumental: true },
				{ title: "Pixel Dreams", src: "/music/Pixel Dreams.mp3", instrumental: true },
				{ title: "Fuego en Mi Corazón", src: "/music/Fuego en Mi Corazón.mp3", instrumental: true },
				{ title: "Groove Machine", src: "/music/Groove Machine.mp3", instrumental: true }
				
			];

			let currentTrack = 0;
			let isPlaying = false;

			document.addEventListener('DOMContentLoaded', () => {
				const audio = document.getElementById('audio-player');
				const songTitle = document.getElementById('song-title');
				const playPauseBtn = document.getElementById('play-pause-btn');
				const playIcon = document.getElementById('play-icon');
				const pauseIcon = document.getElementById('pause-icon');
				const prevBtn = document.getElementById('prev-btn');
				const nextBtn = document.getElementById('next-btn');
				const muteBtn = document.getElementById('mute-btn');
				const volumeIcon = document.getElementById('volume-icon');
				const muteIcon = document.getElementById('mute-icon');
				const progressBar = document.getElementById('progress-bar');

				// Load track
				function loadTrack(index) {
					const track = playlist[index];
					const player = document.getElementById('music-player');
					audio.src = track.src;
					songTitle.textContent = track.title;
					
					// Change player style based on instrumental/vocal
					if (track.instrumental) {
						// Instrumental: Purple theme
						player.style.borderColor = 'rgba(255, 255, 255, 0.8)';
						player.style.backgroundColor = 'rgba(0, 0, 0, 0.9)';
					} else {
						// Vocal: Orange/amber theme with glow
						player.style.borderColor = 'rgba(251, 146, 60, 0.8)';
						player.style.backgroundColor = 'rgba(20, 10, 0, 0.9)';
						player.style.boxShadow = '0 0 30px rgba(251, 146, 60, 0.3)';
					}
					
					audio.load();
				}

				// Play event - add animation for vocal tracks
				audio.addEventListener('play', () => {
					const track = playlist[currentTrack];
					const player = document.getElementById('music-player');
					
					if (!track.instrumental) {
						// Pulse animation for vocal tracks
						player.style.animation = 'pulse 2s ease-in-out infinite';
					} else {
						player.style.animation = 'none';
					}
				});

				audio.addEventListener('pause', () => {
					const player = document.getElementById('music-player');
					player.style.animation = 'none';
				});

				// Play/Pause
				playPauseBtn.addEventListener('click', () => {
					if (isPlaying) {
						audio.pause();
						playIcon.classList.remove('hidden');
						pauseIcon.classList.add('hidden');
					} else {
						audio.play();
						playIcon.classList.add('hidden');
						pauseIcon.classList.remove('hidden');
					}
					isPlaying = !isPlaying;
				});

				// Previous
				prevBtn.addEventListener('click', () => {
					currentTrack = (currentTrack - 1 + playlist.length) % playlist.length;
					loadTrack(currentTrack);
					if (isPlaying) audio.play();
				});

				// Next
				nextBtn.addEventListener('click', () => {
					currentTrack = (currentTrack + 1) % playlist.length;
					loadTrack(currentTrack);
					if (isPlaying) audio.play();
				});

				// Mute
				muteBtn.addEventListener('click', () => {
					audio.muted = !audio.muted;
					if (audio.muted) {
						volumeIcon.classList.add('hidden');
						muteIcon.classList.remove('hidden');
					} else {
						volumeIcon.classList.remove('hidden');
						muteIcon.classList.add('hidden');
					}
				});

				// Progress bar
				audio.addEventListener('timeupdate', () => {
					const progress = (audio.currentTime / audio.duration) * 100;
					progressBar.style.width = progress + '%';
				});

				// Auto next on end
				audio.addEventListener('ended', () => {
					currentTrack = (currentTrack + 1) % playlist.length;
					loadTrack(currentTrack);
					audio.play();
				});

				// Initialize
				loadTrack(currentTrack);
			});

			// Custom Cursor Movement
			const cursorDot = document.getElementById('cursor-dot');
			const cursorOutline = document.getElementById('cursor-outline');

			let mouseX = 0, mouseY = 0;
			let outlineX = 0, outlineY = 0;

			document.addEventListener('mousemove', (e) => {
				mouseX = e.clientX;
				mouseY = e.clientY;

				// Instant follow for dot
				cursorDot.style.left = mouseX + 'px';
				cursorDot.style.top = mouseY + 'px';
			});

			// Smooth follow for outline with delay
			function animateOutline() {
				outlineX += (mouseX - outlineX) * 0.15;
				outlineY += (mouseY - outlineY) * 0.15;

				cursorOutline.style.left = outlineX + 'px';
				cursorOutline.style.top = outlineY + 'px';

				requestAnimationFrame(animateOutline);
			}
			animateOutline();

			// Hover detection
			document.addEventListener('mouseover', (e) => {
				if (e.target.matches('a, button, input, textarea, select')) {
					cursorDot.style.transform = 'translate(-50%, -50%) scale(1.5)';
					cursorOutline.style.width = '60px';
					cursorOutline.style.height = '60px';
					cursorOutline.style.borderColor = 'rgba(225, 225, 225, 0.8)';
				}
			});

			document.addEventListener('mouseout', (e) => {
				if (e.target.matches('a, button, input, textarea, select')) {
					cursorDot.style.transform = 'translate(-50%, -50%) scale(1)';
					cursorOutline.style.width = '40px';
					cursorOutline.style.height = '40px';
					cursorOutline.style.borderColor = 'rgba(225, 225, 225, 0.5)';
				}
			});

			// Hide cursor when leaving window
			document.addEventListener('mouseleave', () => {
				cursorDot.style.opacity = '0';
				cursorOutline.style.opacity = '0';
			});

			document.addEventListener('mouseenter', () => {
				cursorDot.style.opacity = '1';
				cursorOutline.style.opacity = '1';
			});
		</script>
	</body>
</html>
